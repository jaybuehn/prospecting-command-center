


  
  
  First Mid Prospecting Command Center – v0.9 (Single‑File)
  
  
  
  
  
  
  
  
  
  
    :root { --brand-navy:#0c2340; --brand-gold:#c99700; --brand-light:#f7f8fa; --brand-text:#0f172a; }
    html,body,#root{height:100%}
  


  

  
    const { useState, useMemo, useEffect, useRef } = React;

    // ===== Brand Tokens
    const BRAND = { navy:'#0c2340', gold:'#c99700', light:'#f7f8fa', text:'#0f172a' };

    // ===== Industries
    const INDUSTRIES = [
      'Trucking & Logistics','Manufacturing','Hospitality / Hotels','Healthcare / Clinics',
      'Real Estate – Investors/Developers','Warehousing','Retail','Construction'
    ];

    // ===== Seed Leads (Effingham area, updated with websites)
    const SEED_LEADS = [
      { id:'L-0001', createdAt:Date.now(), name:'Midwest Freight LLC', industry:'Trucking & Logistics', city:'Effingham, IL', address:'1200 W Evergreen Ave, Effingham, IL 62401', radiusMiles:10, source:'Chamber', employees:40, founded:2012, website:'https://midwestfreight.com', decisionMakers:[{name:'Sandra Keller', title:'Owner', email:'sandra@midwestfreight.com', phone:'(217) 555-0186'},{name:'Tom Ruiz', title:'Controller', email:'truiz@midwestfreight.com', phone:'(217) 555-0133'}], notes:'Added from Chamber new members list.', flags:['Growing fleet','Facility expansion 2024'], status:'New Lead' },
      { id:'L-0002', createdAt:Date.now(), name:'Blue Ridge Hospitality Group, LLC', industry:'Hospitality / Hotels', city:'Mattoon, IL', address:'505 S 21st St, Mattoon, IL 61938', radiusMiles:26, source:'CRE Listing', employees:22, founded:2016, website:'https://blueridgehg.com', decisionMakers:[{name:'Raj Shah', title:'Managing Member', email:'rshah@blueridgehg.com', phone:'(217) 555-0440'}], cre:'Active listing near I-57; listing agent: Miller CRE.', notes:'Potential SBA 7(a) eligible; seasonal swings.', flags:['New listing','High traffic corridor'], status:'New Lead' },
      { id:'L-0003', createdAt:Date.now(), name:'Prairie Precision Manufacturing, Inc.', industry:'Manufacturing', city:'Teutopolis, IL', address:'140 Industrial Park Rd, Teutopolis, IL 62467', radiusMiles:12, source:'Recorder – Mortgage', employees:85, founded:2004, website:'https://prairieprecision.com', decisionMakers:[{name:'Megan Voss', title:'CFO', email:'mvoss@prairieprecision.com', phone:'(217) 555-0172'}], filings:'Mortgage recorded Dec 2024; equip capex increasing.', notes:'Open to equipment lease vs loan conversation.', flags:['Recent mortgage','Capex plan'], status:'New Lead' },
      { id:'L-0004', createdAt:Date.now(), name:'Watts Copy Systems', industry:'Manufacturing', city:'Effingham, IL', address:'', radiusMiles:10, source:'Chamber', employees:null, founded:null, website:'https://wattscopysystems.com', decisionMakers:[], notes:'New member as of August 21, 2025.', flags:['New member'], status:'New Lead' },
      { id:'L-0005', createdAt:Date.now(), name:'ADM Animal Nutrition', industry:'Manufacturing', city:'Effingham, IL', address:'1200 McGrath Avenue, Effingham, IL', radiusMiles:10, source:'Chamber', employees:null, founded:null, website:'https://www.adm.com', decisionMakers:[], notes:'New member as of August 26, 2025.', flags:['New member'], status:'New Lead' },
      { id:'L-0006', createdAt:Date.now(), name:'Commercial Property at 805 N Keller Dr', industry:'Retail', city:'Effingham, IL', address:'805 N Keller Dr, Effingham, IL', radiusMiles:10, source:'CRE Listing', employees:null, founded:null, website:'', decisionMakers:[], notes:'Recent commercial/retail listing.', flags:['New listing'], status:'New Lead' }
    ];

    // ===== Local storage helpers
    const storage = {
      load(key, fallback){ try{ const raw=localStorage.getItem(key); return raw?JSON.parse(raw):fallback; }catch{return fallback;} },
      save(key, val){ try{ localStorage.setItem(key, JSON.stringify(val)); }catch{} }
    };

    // ===== Activity logging
    function logActivity(type, details) {
      const log = storage.load('fm_activity_log', []);
      log.push({ timestamp: Date.now(), type, details });
      storage.save('fm_activity_log', log);
    }

    // ===== Product recommendation
    function recommendProducts(industry, signals=[]) {
      const s=(v)=>signals.some(x=>v && String(x).toLowerCase().includes(v.toLowerCase()));
      const base=[];
      switch(industry){
        case 'Trucking & Logistics': base.push('Equipment Financing','Revolving Line of Credit','Treasury/Cash Management'); if(s('expansion')||s('fleet')) base.push('Term Loan (Fleet Expansion)'); break;
        case 'Manufacturing': base.push('Equipment Loan/Lease','Working Capital LOC','Treasury/Cash Management','Merchant Services'); if(s('capex')) base.push('CAPEX Term Loan'); break;
        case 'Hospitality / Hotels': base.push('CRE Loan','SBA 7(a) or 504','Treasury/Cash Management'); break;
        case 'Healthcare / Clinics': base.push('Practice Loan','Equipment Financing','CRE Loan','Merchant Services'); break;
        case 'Real Estate – Investors/Developers': base.push('CRE Loan','Construction Loan','Treasury/Cash Management'); break;
        case 'Warehousing': base.push('CRE Loan','Working Capital LOC','Treasury/Cash Management'); break;
        case 'Retail': base.push('Merchant Services','Working Capital LOC','Treasury/Cash Management'); break;
        case 'Construction': base.push('Equipment Financing','Working Capital LOC','Treasury/Cash Management'); break;
        default: base.push('Working Capital LOC','Treasury/Cash Management');
      }
      return [...new Set(base)];
    }

    // ===== Outreach (Jay)
    const JAY = { name:'Jay Buehnerkemper', title:'VP, Community Bank President | Commercial Lending', nmls:'NMLS# 583875', phone:'217-342-6132', mobile:'217-821-8186', address:'902 N. Keller Drive, Effingham, IL 62401', emailHref:'https://www.firstmid.com/representative/jay-buehnerkemper/', bank:'First Mid Bank & Trust', site:'firstmid.com' };

    function callScript(p){
      const prods = recommendProducts(p.industry, [...(p.flags||[]), p.notes||'']);
      return `Hi, this is ${JAY.name} with ${JAY.bank} here in Effingham. I work with ${p.industry.toLowerCase()} clients like ${p.name}. ${p.flags?.length?`I saw ${p.flags.join(' and ')}. `:''}We often help with ${prods.slice(0,2).join(' and ')} to support growth and cash flow. Would it be a bad time to ask how you’re handling ${prods[0].toLowerCase()} today?`;
    }

    function emailTemplate(p){
      const prods = recommendProducts(p.industry, [...(p.flags||[]), p.notes||'']);
      return `Subject: ${p.name} – banking support for growth

Hi ${p.decisionMakers?.[0]?.name || 'there'},

I’m ${JAY.name}, ${JAY.title} at ${JAY.bank}. I work with ${p.industry.toLowerCase()} clients in the ${p.city} area. ${p.flags?.length?`I noticed ${p.flags.join(' and ')}. `:''}Based on similar clients, the biggest wins usually come from ${prods.slice(0,3).join(', ')}. If helpful, I can share a 10-minute overview and ideas tailored to ${p.name}.

Would you be open to a brief call next week?

${JAY.name}
${JAY.title}
${JAY.nmls}
${JAY.bank}
Direct: ${JAY.phone} | Mobile: ${JAY.mobile}
${JAY.address}
Profile: ${JAY.emailHref}`;
    }

    function letterTemplate(p){
      const prods = recommendProducts(p.industry, [...(p.flags||[]), p.notes||'']);
      const today = new Date().toLocaleDateString();
      return `${today}

${p.name}
${p.address}

Re: Banking solutions to support ${p.industry.toLowerCase()}

To whom it may concern,

I’m ${JAY.name}, ${JAY.title} with ${JAY.bank} in Effingham. We support businesses across the region with solutions such as ${prods.slice(0,3).join(', ')}. ${p.flags?.length?`Given ${p.flags.join(' and ')}, `:''}I believe a brief conversation could surface opportunities to optimize financing and cash management for ${p.name}.

I will follow up by phone next week. In the meantime, please feel free to reach me at ${JAY.phone} or ${JAY.mobile}.

Sincerely,

${JAY.name}
${JAY.title}
${JAY.nmls}
${JAY.bank}
${JAY.address}`;
    }

    // ===== Alert Details Data (based on recent searches as of September 3, 2025)
    const ALERT_DATA = {
      chamber: [
        { name: 'ADM Animal Nutrition', industry: 'Manufacturing', joinDate: 'August 26, 2025', link: 'https://effinghamcountychamber.com/member/adm-animal-nutrition/', details: 'New member picture event.' },
        { name: 'Watts Copy Systems', industry: 'Manufacturing', joinDate: 'August 21, 2025', link: 'https://effinghamcountychamber.com/member/watts-copy-systems/', details: 'New member picture event.' },
        { name: 'Jim Newbanks', industry: 'Other', joinDate: '2025', link: 'https://effinghamcountychamber.com/360-magazine/', details: 'Listed as new member/friend in 2025 directory.' }
      ],
      cre: [
        { name: '1110 School St', address: '1110 School St, Effingham, IL', price: '$1,200,000', size: '10,000 sq ft', type: 'Retail', link: 'https://www.loopnet.com/Listing/1110-School-St-Effingham-IL/12345678/' },
        { name: '805 N Keller Dr', address: '805 N Keller Dr, Effingham, IL', price: '$850,000', size: '8,500 sq ft', type: 'Office', link: 'https://www.loopnet.com/Listing/805-N-Keller-Dr-Effingham-IL/87654321/' },
        { name: 'Commercial Land Parcel', address: 'Lot near I-57, Effingham, IL', price: '$500,000', size: '2 acres', type: 'Land', link: 'https://www.crexi.com/properties/IL/Effingham/land-parcel' }
      ],
      mortgages: [
        { business: 'Sample Business A', date: 'August 15, 2025', type: 'Commercial Mortgage', details: 'Recorded at Effingham County Recorder.', link: 'https://www.efzco.org/recorder/search' },
        { business: 'Sample Business B', date: 'September 1, 2025', type: 'Mortgage Release', details: 'Released lien on property.', link: 'https://www.efzco.org/recorder/search' }
      ],
      ucc: [
        { business: 'Sample UCC Filer', date: 'August 20, 2025', type: 'New UCC Filing', details: 'Equipment collateral.', link: 'https://www.ilsos.gov/uccsearch/' },
        { business: 'Sample UCC Release', date: 'September 2, 2025', type: 'UCC Release', details: 'Released security interest.', link: 'https://www.ilsos.gov/uccsearch/' }
      ]
    };

    // ===== Small UI bits
    const Tag = ({children}) => <span className="inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-700 mr-1 mb-1">{children}</span>;
    const CopyButton = ({text,label='Copy', onCopy}) => <button onClick={()=>{navigator.clipboard.writeText(text); if(onCopy) onCopy();}} className="text-sm px-3 py-1 rounded-lg border border-gray-300 hover:border-gray-400" title="Copy to clipboard">{label}</button>;
    const Section = ({title,right,children,pad=true}) => (
      <div className="bg-white rounded-2xl shadow-sm border border-gray-200">
        <div className="flex items-center justify-between px-4 sm:px-6 py-3 border-b border-gray-100">
          <h3 className="font-semibold text-slate-800">{title}</h3>
          <div>{right}</div>
        </div>
        <div className={pad?"p-4 sm:p-6":""}>{children}</div>
      </div>
    );

    function printLetter(text, onPrint){
      const html = `<!doctype html><html><head><meta charset='utf-8'/><title>Letter</title><style>body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Noto Sans; margin:40px; color:${BRAND.text}}h1{font-size:18px;margin:0 0 8px 0}.meta{color:#475569;font-size:12px}.brand{color:${BRAND.navy};border-top:2px solid ${BRAND.gold};padding-top:8px;margin-top:24px;font-weight:600}pre{white-space:pre-wrap;font-size:14px}</style></head><body><h1>${JAY.bank}</h1><div class="meta">${JAY.address} · ${JAY.phone} · ${JAY.mobile}</div><pre>${text}</pre><div class="brand">${JAY.name} — ${JAY.title}</div></body></html>`;
      const w = window.open('', '_blank', 'noopener,noreferrer,width=800,height=1000');
      if(!w) return alert('Pop-up blocked. Allow pop-ups to print.');
      w.document.open(); w.document.write(html); w.document.close(); w.focus(); w.print();
      if(onPrint) onPrint();
    }

    function ContactEditor({ value, onChange }){
      const [list,setList] = useState(value||[]);
      useEffect(()=>setList(value||[]),[value]);
      function upd(i,patch){ const n=list.map((c,idx)=>idx===i?{...c,...patch}:c); setList(n); onChange(n); }
      function add(){ const n=[...list,{name:'',title:'',email:'',phone:''}]; setList(n); onChange(n); }
      function rm(i){ const n=list.filter((_,idx)=>idx!==i); setList(n); onChange(n); }
      return (
        <div className="space-y-2">
          {list.map((c,idx)=> (
            <div key={idx} className="grid grid-cols-1 sm:grid-cols-4 gap-2">
              <input className="rounded-lg border px-3 py-2" placeholder="Name" value={c.name} onChange={e=>upd(idx,{name:e.target.value})} title="Decision maker's name" />
              <input className="rounded-lg border px-3 py-2" placeholder="Title" value={c.title} onChange={e=>upd(idx,{title:e.target.value})} title="Decision maker's title" />
              <input className="rounded-lg border px-3 py-2" placeholder="Email" value={c.email} onChange={e=>upd(idx,{email:e.target.value})} title="Decision maker's email" />
              <div className="flex gap-2">
                <input className="flex-1 rounded-lg border px-3 py-2" placeholder="Phone" value={c.phone} onChange={e=>upd(idx,{phone:e.target.value})} title="Decision maker's phone" />
                <button className="px-3 py-2 rounded-lg border" onClick={()=>rm(idx)}>–</button>
              </div>
            </div>
          ))}
          <div><button className="px-3 py-2 rounded-lg border" onClick={add}>+ Add Contact</button></div>
        </div>
      );
    }

    function ListEditor({ label, list, onChange }){
      const [items,setItems]=useState(list||[]);
      useEffect(()=>setItems(list||[]),[list]);
      function upd(i,v){ const n=items.map((x,idx)=>idx===i?v:x); setItems(n); onChange(n); }
      function add(){ const n=[...items,'']; setItems(n); onChange(n); }
      function rm(i){ const n=items.filter((_,idx)=>idx!==i); setItems(n); onChange(n); }
      return (
        <div>
          <div className="text-xs text-slate-500 mb-1">{label}</div>
          <div className="space-y-2">
            {items.map((v,i)=> (
              <div key={i} className="flex gap-2">
                <input className="flex-1 rounded-lg border px-3 py-2" value={v} onChange={e=>upd(i,e.target.value)} />
                <button className="px-3 py-2 rounded-lg border" onClick={()=>rm(i)}>–</button>
              </div>
            ))}
            <button className="px-3 py-2 rounded-lg border" onClick={add}>+ Add</button>
          </div>
        </div>
      );
    }

    function QuickAdd({ onAdd }){
      const [name,setName]=useState('');
      const [industry,setIndustry]=useState(INDUSTRIES[0]);
      const [city,setCity]=useState('Effingham, IL');
      const [miles,setMiles]=useState(10);
      return (
        <div className="grid grid-cols-1 sm:grid-cols-5 gap-3 text-sm">
          <input className="rounded-lg border px-3 py-2 sm:col-span-2" placeholder="Business name" value={name} onChange={e=>setName(e.target.value)} />
          <select className="rounded-lg border px-3 py-2" value={industry} onChange={e=>setIndustry(e.target.value)}>{INDUSTRIES.map(i=><option key={i}>{i}</option>)}</select>
          <input className="rounded-lg border px-3 py-2" placeholder="City" value={city} onChange={e=>setCity(e.target.value)} />
          <input className="rounded-lg border px-3 py-2" type="number" placeholder="Miles" value={miles} onChange={e=>setMiles(Number(e.target.value))} />
          <div className="sm:col-span-5 flex justify-end">
            <button className="rounded-xl px-3 py-2 text-sm font-medium text-white" style={{backgroundColor:BRAND.navy}}
              onClick={()=>{ if(!name.trim()) return; onAdd({ id:`L-${Math.random().toString(36).slice(2,8)}`, createdAt:Date.now(), name, industry, city, address:'', radiusMiles:miles, source:'Manual', website:'', decisionMakers:[], notes:'', flags:[], status:'New Lead' }); setName(''); setMiles(10); setIndustry(INDUSTRIES[0]); }}>
              Add
            </button>
          </div>
        </div>
      );
    }

    function ProspectCard({ p }){
      const prods = recommendProducts(p.industry, [...(p.flags||[]), p.notes||'']);
      const isValidUrl = p.website && (p.website.startsWith('http://') || p.website.startsWith('https://'));
      return (
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-4 text-sm">
          <div className="lg:col-span-2">
            <div className="mb-2">
              <div className="text-lg font-semibold">{p.name}</div>
              <div className="text-slate-500">{p.industry} • {p.city}</div>
            </div>
            <div className="mb-3">
              <div className="text-xs text-slate-500 mb-1">Recommended Products</div>
              <div className="flex flex-wrap">{prods.map(r=> <Tag key={r}>{r}</Tag>)}</div>
            </div>
            <div className="mb-3">
              <div className="text-xs text-slate-500 mb-1">Notes</div>
              <div className="text-slate-700">{p.notes || '—'}</div>
            </div>
            <div className="mb-3">
              <div className="text-xs text-slate-500 mb-1">Website</div>
              <div className="text-slate-700">
                {isValidUrl ? (
                  <a href={p.website} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">{p.website}</a>
                ) : (
                  p.website || '—'
                )}
              </div>
            </div>
            <div className="flex gap-2">
              <CopyButton text={callScript(p)} onCopy={() => logActivity('outreach', `Copied call script for ${p.name}`)} label="Copy Call Script" />
              <CopyButton text={emailTemplate(p)} onCopy={() => logActivity('outreach', `Copied email for ${p.name}`)} label="Copy Email" />
              <button className="px-3 py-1 rounded-lg border" onClick={() => printLetter(letterTemplate(p), () => logActivity('outreach', `Printed letter for ${p.name}`))}>Print Letter</button>
            </div>
          </div>
          <div>
            <div className="text-xs text-slate-500 mb-1">Decision Makers</div>
            <div className="space-y-2">{(p.decisionMakers||[]).map((d,idx)=> (
              <div key={idx} className="p-3 border rounded-xl bg-white">
                <div className="font-medium">{d.name}</div>
                <div className="text-slate-500">{d.title}</div>
                <div>{d.email||'—'}</div>
                <div>{d.phone||'—'}</div>
              </div>
            ))}</div>
          </div>
        </div>
      );
    }

    function Editor({ p, onChange, onRemove }){
      const [form,setForm]=useState(p);
      useEffect(()=>setForm(p),[p]);
      useEffect(()=>{ if(!form) return; onChange(form); },[form]);
      if(!p) return null;
      return (
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
          <div title="Business name">
            <label className="block text-xs text-slate-500 mb-1">Name</label>
            <input value={form.name} onChange={e=>setForm({...form,name:e.target.value})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div title="Select industry for product recommendations">
            <label className="block text-xs text-slate-500 mb-1">Industry</label>
            <select value={form.industry} onChange={e=>setForm({...form,industry:e.target.value})} className="w-full rounded-lg border px-3 py-2">{INDUSTRIES.map(i=> <option key={i} value={i}>{i}</option>)}</select>
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">City</label>
            <input value={form.city} onChange={e=>setForm({...form,city:e.target.value})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div title="Radius in miles from Effingham for filtering">
            <label className="block text-xs text-slate-500 mb-1">Miles (radius)</label>
            <input type="number" value={form.radiusMiles} onChange={e=>setForm({...form,radiusMiles:Number(e.target.value)})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div className="sm:col-span-2">
            <label className="block text-xs text-slate-500 mb-1">Address</label>
            <input value={form.address} onChange={e=>setForm({...form,address:e.target.value})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div>
            <label className="block text-xs text-slate-500 mb-1">Source</label>
            <select value={form.source} onChange={e=>setForm({...form,source:e.target.value})} className="w-full rounded-lg border px-3 py-2">{['Chamber','CRE Listing','Recorder – Mortgage','Manual'].map(s=> <option key={s} value={s}>{s}</option>)}</select>
          </div>
          <div title="Approximate number of employees">
            <label className="block text-xs text-slate-500 mb-1">Employees</label>
            <input type="number" value={form.employees||''} onChange={e=>setForm({...form,employees:Number(e.target.value)||undefined})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div title="Year founded">
            <label className="block text-xs text-slate-500 mb-1">Founded</label>
            <input type="number" value={form.founded||''} onChange={e=>setForm({...form,founded:Number(e.target.value)||undefined})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div title="Business website URL (include http:// or https://)">
            <label className="block text-xs text-slate-500 mb-1">Website</label>
            <input value={form.website||''} onChange={e=>setForm({...form,website:e.target.value})} className="w-full rounded-lg border px-3 py-2" placeholder="https://example.com" />
          </div>
          <div className="sm:col-span-2" title="Additional notes or signals">
            <label className="block text-xs text-slate-500 mb-1">Notes</label>
            <textarea value={form.notes||''} onChange={e=>setForm({...form,notes:e.target.value})} className="w-full rounded-lg border px-3 py-2 h-24" />
          </div>
          <div className="sm:col-span-2" title="Comma-separated flags for product recs (e.g., expansion, capex)">
            <label className="block text-xs text-slate-500 mb-1">Flags (comma-separated)</label>
            <input value={(form.flags||[]).join(', ')} onChange={e=>setForm({...form,flags:e.target.value.split(',').map(x=>x.trim()).filter(Boolean)})} className="w-full rounded-lg border px-3 py-2" />
          </div>
          <div className="sm:col-span-2" title="Add decision makers with contact info">
            <label className="block text-xs text-slate-500 mb-1">Decision Makers</label>
            <ContactEditor value={form.decisionMakers||[]} onChange={(list)=>setForm({...form,decisionMakers:list})} />
          </div>
          <div title="Current pipeline stage">
            <label className="block text-xs text-slate-500 mb-1">Stage</label>
            <select value={form.status} onChange={e=>setForm({...form,status:e.target.value})} className="w-full rounded-lg border px-3 py-2">{['New Lead','Contacted','Meeting','Proposal','Won','Lost'].map(s=> <option key={s}>{s}</option>)}</select>
          </div>
          <div className="flex items-end justify-between sm:col-span-2">
            <div className="text-xs text-slate-500">ID: {p.id}</div>
            <button className="px-3 py-1 rounded-lg border border-red-300 text-red-600" onClick={()=>onRemove(p.id)}>Delete</button>
          </div>
        </div>
      );
    }

    function AlertDetails(){
      return (
        <div className="space-y-6">
          <Section title="New Chamber Members">
            <div className="overflow-auto">
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-500">
                    <th className="py-2 pr-3">Name</th>
                    <th className="py-2 pr-3">Industry</th>
                    <th className="py-2 pr-3">Join Date</th>
                    <th className="py-2 pr-3">Details</th>
                    <th className="py-2 pr-3">Link</th>
                  </tr>
                </thead>
                <tbody>
                  {ALERT_DATA.chamber.map((m,i) => (
                    <tr key={i} className="border-t">
                      <td className="py-3 pr-3">{m.name}</td>
                      <td className="py-3 pr-3">{m.industry}</td>
                      <td className="py-3 pr-3">{m.joinDate}</td>
                      <td className="py-3 pr-3">{m.details}</td>
                      <td className="py-3 pr-3"><a href={m.link} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">View</a></td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </Section>

          <Section title="New CRE Listings">
            <div className="overflow-auto">
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-500">
                    <th className="py-2 pr-3">Name</th>
                    <th className="py-2 pr-3">Address</th>
                    <th className="py-2 pr-3">Price</th>
                    <th className="py-2 pr-3">Size</th>
                    <th className="py-2 pr-3">Type</th>
                    <th className="py-2 pr-3">Link</th>
                  </tr>
                </thead>
                <tbody>
                  {ALERT_DATA.cre.map((c,i) => (
                    <tr key={i} className="border-t">
                      <td className="py-3 pr-3">{c.name}</td>
                      <td className="py-3 pr-3">{c.address}</td>
                      <td className="py-3 pr-3">{c.price}</td>
                      <td className="py-3 pr-3">{c.size}</td>
                      <td className="py-3 pr-3">{c.type}</td>
                      <td className="py-3 pr-3"><a href={c.link} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">View</a></td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </Section>

          <Section title="Recent Mortgages">
            <div className="overflow-auto">
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-500">
                    <th className="py-2 pr-3">Business</th>
                    <th className="py-2 pr-3">Date</th>
                    <th className="py-2 pr-3">Type</th>
                    <th className="py-2 pr-3">Details</th>
                    <th className="py-2 pr-3">Link</th>
                  </tr>
                </thead>
                <tbody>
                  {ALERT_DATA.mortgages.map((m,i) => (
                    <tr key={i} className="border-t">
                      <td className="py-3 pr-3">{m.business}</td>
                      <td className="py-3 pr-3">{m.date}</td>
                      <td className="py-3 pr-3">{m.type}</td>
                      <td className="py-3 pr-3">{m.details}</td>
                      <td className="py-3 pr-3"><a href={m.link} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">View</a></td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </Section>

          <Section title="Recent UCC Filings/Releases">
            <div className="overflow-auto">
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-500">
                    <th className="py-2 pr-3">Business</th>
                    <th className="py-2 pr-3">Date</th>
                    <th className="py-2 pr-3">Type</th>
                    <th className="py-2 pr-3">Details</th>
                    <th className="py-2 pr-3">Link</th>
                  </tr>
                </thead>
                <tbody>
                  {ALERT_DATA.ucc.map((u,i) => (
                    <tr key={i} className="border-t">
                      <td className="py-3 pr-3">{u.business}</td>
                      <td className="py-3 pr-3">{u.date}</td>
                      <td className="py-3 pr-3">{u.type}</td>
                      <td className="py-3 pr-3">{u.details}</td>
                      <td className="py-3 pr-3"><a href={u.link} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">View</a></td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </Section>
        </div>
      );
    }

    function Reports(){
      const log = useMemo(()=> storage.load('fm_activity_log', []),[ ]);
      const summary = useMemo(()=> {
        const counts = { add:0, update:0, remove:0, outreach:0 };
        log.forEach(entry => counts[entry.type] = (counts[entry.type] || 0) + 1);
        const today = new Date().toLocaleDateString();
        return `Activity Report as of ${today}:

- Added ${counts.add} new leads
- Updated ${counts.update} leads
- Removed ${counts.remove} leads
- Generated outreach ${counts.outreach} times`;
      }, [log]);
      return (
        <div className="space-y-6">
          <Section title="Activity Summary" right={<CopyButton text={summary} label="Copy Report" />}>
            <pre className="whitespace-pre-wrap text-sm">{summary}</pre>
          </Section>
          <Section title="Detailed Log" pad={false}>
            <div className="overflow-auto max-h-96">
              <table className="min-w-full text-sm">
                <thead>
                  <tr className="text-left text-slate-500">
                    <th className="py-2 pr-3 sticky top-0 bg-white">Time</th>
                    <th className="py-2 pr-3 sticky top-0 bg-white">Type</th>
                    <th className="py-2 pr-3 sticky top-0 bg-white">Details</th>
                  </tr>
                </thead>
                <tbody>
                  {log.slice().reverse().map((entry, i) => (
                    <tr key={i} className="border-t">
                      <td className="py-3 pr-3">{new Date(entry.timestamp).toLocaleString()}</td>
                      <td className="py-3 pr-3 capitalize">{entry.type}</td>
                      <td className="py-3 pr-3">{entry.details}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </Section>
          <div className="text-right">
            <button className="text-sm px-3 py-1 rounded-lg border border-red-300 text-red-600" onClick={() => {storage.save('fm_activity_log', []); window.location.reload();}}>Clear Log</button>
          </div>
        </div>
      );
    }

    function App(){
      const [tab,setTab]=useState('dashboard');
      const [prospects,setProspects]=useState(()=> storage.load('fm_prospects', SEED_LEADS));
      const [query,setQuery]=useState('');
      const [industry,setIndustry]=useState('');
      const [radius,setRadius]=useState(20);
      const [source,setSource]=useState('All');
      const [selected,setSelected]=useState(null);
      const [settings,setSettings]=useState(()=> storage.load('fm_settings', {
        defaultRadius:20,
        chamberUrls:['https://effinghamcountychamber.com/directory/'],
        creSources:['https://www.loopnet.com/','https://www.crexi.com/'],
        recorderPortals:['https://www.efzco.org/recorder/'],
        industries:INDUSTRIES,
        agentLogin:{enabled:false,note:'Phase 2: credentials stored in session only.'}
      }));
      useEffect(()=>storage.save('fm_prospects',prospects),[prospects]);
      useEffect(()=>storage.save('fm_settings',settings),[settings]);

      const tabs=[
        {id:'dashboard',label:'Dashboard'},
        {id:'alerts',label:'Alerts'},
        {id:'search',label:'Search'},
        {id:'leads',label:'Leads'},
        {id:'outreach',label:'Outreach'},
        {id:'reports',label:'Reports'},
        {id:'settings',label:'Settings'}
      ];

      const filtered = useMemo(()=> prospects.filter(p=>{
        const matchQ = !query || (p.name+p.city+p.address+p.industry+p.website).toLowerCase().includes(query.toLowerCase());
        const matchI = !industry || p.industry===industry;
        const matchR = !radius || p.radiusMiles <= radius;
        const matchS = source === 'All' || p.source===source;
        return matchQ && matchI && matchR && matchS;
      }),[prospects,query,industry,radius,source]);

      const stages=['New Lead','Contacted','Meeting','Proposal','Won','Lost'];
      const todayAlerts=[
        {type:'Recorder',text:'2 new commercial mortgages recorded in Effingham County.',sourceUrl:settings.recorderPortals[0]},
        {type:'Chamber',text:'2 new members added (manufacturing x2).',sourceUrl:settings.chamberUrls[0]},
        {type:'CRE',text:'9 recent listings available within Effingham area.',sourceUrl:settings.creSources[0]},
      ];

      function addProspect(){
        const newP={ id:`L-${Math.random().toString(36).slice(2,8)}`, createdAt:Date.now(), name:'New Business', industry:settings.industries[0]||'Trucking & Logistics', city:'Effingham, IL', address:'', radiusMiles:settings.defaultRadius||20, source:'Manual', website:'', decisionMakers:[], notes:'', flags:[], status:'New Lead' };
        setProspects([newP, ...prospects]); 
        logActivity('add', `Added new prospect: ${newP.name}`);
        setSelected(newP); setTab('leads');
      }
      function updateProspect(patch){ 
        setProspects(arr=>arr.map(p=> p.id===patch.id?{...p,...patch}:p)); 
        logActivity('update', `Updated prospect: ${patch.name || patch.id}`);
      }
      function removeProspect(id){ 
        setProspects(arr=>arr.filter(p=>p.id!==id)); 
        logActivity('remove', `Removed prospect: ${id}`);
        if(selected?.id===id) setSelected(null); 
      }

      // Handle link clicks with error feedback
      function handleAlertLinkClick(url, event) {
        try {
          console.log(`Opening alert link: ${url}`);
          const newWindow = window.open(url, '_blank', 'noopener,noreferrer');
          if (!newWindow) {
            alert('Unable to open the link. Please allow pop-ups for this site or open the URL manually: ' + url);
          }
        } catch (err) {
          console.error('Error opening link:', err);
          alert('Error opening link: ' + (err.message || err));
        }
      }

      const pipelineChartRef = useRef(null);
      const pipelineChartInstance = useRef(null);
      useEffect(() => {
        if (pipelineChartRef.current) {
          if (pipelineChartInstance.current) pipelineChartInstance.current.destroy();
          const ctx = pipelineChartRef.current.getContext('2d');
          pipelineChartInstance.current = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: stages,
              datasets: [{
                label: 'Leads',
                data: stages.map(s => prospects.filter(p => p.status === s).length),
                backgroundColor: BRAND.gold,
              }]
            },
            options: {
              scales: {
                y: { beginAtZero: true }
              }
            }
          });
        }
        return () => { if (pipelineChartInstance.current) pipelineChartInstance.current.destroy(); };
      }, [prospects]);

      return (
        <div className="min-h-screen">
          <header className="sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/70 bg-white/90 border-b border-gray-200">
            <div className="max-w-7xl mx-auto px-4 sm:px-6">
              <div className="flex items-center justify-between h-16">
                <div className="flex items-center gap-3">
                  <div className="w-9 h-9 rounded-xl border flex items-center justify-center" style={{borderColor:BRAND.gold}}>
                    <span className="font-bold" style={{color:BRAND.navy}}>FM</span>
                  </div>
                  <div>
                    <div className="text-sm text-slate-500 leading-tight">First Mid Bank & Trust</div>
                    <div className="font-semibold" style={{color:BRAND.navy}}>Prospecting Command Center</div>
                  </div>
                </div>
                <div className="hidden sm:flex items-center gap-6">
                  <div className="text-right">
                    <div className="text-xs text-slate-500">Signed in as</div>
                    <div className="text-sm font-medium">{JAY.name}</div>
                  </div>
                  <button onClick={addProspect} className="rounded-xl px-3 py-2 text-sm font-medium text-white" style={{backgroundColor:BRAND.navy}}>+ Add Prospect</button>
                </div>
              </div>
            </div>
          </header>

          <main className="max-w-7xl mx-auto px-4 sm:px-6 py-6">
            <nav className="mb-6 flex flex-wrap gap-2">
              {tabs.map(t=> (
                <button key={t.id} onClick={()=>setTab(t.id)} className={`px-4 py-2 rounded-2xl border text-sm font-medium ${tab===t.id?'bg-white border-gray-300':'bg-gray-50 border-gray-200 hover:bg-white'}`}>{t.label}</button>
              ))}
            </nav>

            {tab==='dashboard' && (
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <Section title="Today’s Alerts" right={<span className="text-xs text-slate-500">auto-refreshed</span>}>
                  <ul className="space-y-2">{todayAlerts.map((a,i)=> (
                    <li key={i} className="flex items-start gap-3">
                      <div className="mt-1 w-2.5 h-2.5 rounded-full" style={{backgroundColor:BRAND.gold}} />
                      <div>
                        <a href={a.sourceUrl} target="_blank" rel="noreferrer" className="text-sm font-medium hover:underline cursor-pointer" onClick={(e) => handleAlertLinkClick(a.sourceUrl, e)}>{a.type}</a>
                        <div className="text-sm text-slate-600">{a.text}</div>
                      </div>
                    </li>
                  ))}</ul>
                </Section>

                <Section title="Recommended Actions">
                  <ul className="text-sm text-slate-700 list-disc pl-6 space-y-2">
                    <li>Call Midwest Freight LLC (fleet expansion noted).</li>
                    <li>Email Blue Ridge Hospitality Group about SBA options.</li>
                    <li>Review Prairie Precision’s 2024 mortgage for refinance opportunity.</li>
                  </ul>
                </Section>

                <Section title="Pipeline Snapshot">
                  <canvas ref={pipelineChartRef} height="200"></canvas>
                </Section>

                <Section title="Quick Add Prospect"><QuickAdd onAdd={(p)=>{ setProspects([p,...prospects]); logActivity('add', `Added new prospect: ${p.name}`); setTab('leads'); setSelected(p); }} /></Section>

                <Section title="Today’s New Leads (sample)">
                  <div className="text-sm text-slate-700">3 items from public sources (Chamber + CRE).</div>
                  <div className="mt-3 space-y-2">
                    {SEED_LEADS.slice(0,3).map(p=> (
                      <div key={p.id} className="flex items-center justify-between p-3 rounded-xl border bg-white">
                        <div>
                          <div className="font-medium">{p.name}</div>
                          <div className="text-xs text-slate-500">{p.industry} • {p.city} • {p.source}</div>
                        </div>
                        <button className="text-sm px-3 py-1 rounded-lg border" onClick={()=>{ setSelected(p); setTab('outreach'); }}>Create Outreach</button>
                      </div>
                    ))}
                  </div>
                </Section>

                <Section title="Your Focus Industries">
                  <div className="flex flex-wrap">{settings.industries.map(i=> <span key={i} className="mr-2 mb-2 px-3 py-1 rounded-full border bg-gray-50 text-sm">{i}</span>)}</div>
                </Section>
              </div>
            )}

            {tab==='alerts' && <AlertDetails />}

            {tab==='search' && (
              <form onSubmit={(e)=>{e.preventDefault();}} className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <Section title="Filters">
                  <div className="space-y-4">
                    <div>
                      <label className="block text-xs text-slate-500 mb-1">Free-text</label>
                      <input value={query} onChange={e=>setQuery(e.target.value)} placeholder="Name, city, address, industry, website" className="w-full rounded-lg border px-3 py-2" />
                    </div>
                    <div>
                      <label className="block text-xs text-slate-500 mb-1">Industry</label>
                      <select value={industry} onChange={e=>setIndustry(e.target.value)} className="w-full rounded-lg border px-3 py-2">
                        <option value="">All</option>
                        {settings.industries.map(i=> <option key={i} value={i}>{i}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-xs text-slate-500 mb-1">Radius (miles)</label>
                      <input type="range" min={5} max={60} step={5} value={radius} onChange={e=>setRadius(Number(e.target.value))} className="w-full" />
                      <div className="text-sm mt-1">Within <span className="font-semibold">{radius} miles</span></div>
                    </div>
                    <div>
                      <label className="block text-xs text-slate-500 mb-1">Source</label>
                      <select value={source} onChange={e=>setSource(e.target.value)} className="w-full rounded-lg border px-3 py-2">{['All','Chamber','CRE Listing','Recorder – Mortgage','Manual'].map(s=> <option key={s} value={s}>{s}</option>)}</select>
                    </div>
                    <div className="pt-2 border-t">
                      <div className="text-xs text-slate-500 mb-2">Data Sources (reference)</div>
                      <ul className="text-sm text-slate-700 list-disc pl-5 space-y-1">
                        {settings.chamberUrls.map((u,idx)=> <li key={idx}><a className="underline" href={u} target="_blank" rel="noreferrer">Chamber Directory</a></li>)}
                        {settings.creSources.map((u,idx)=> <li key={idx}><a className="underline" href={u} target="_blank" rel="noreferrer">CRE Listings</a></li>)}
                      </ul>
                    </div>
                    <button type="submit" className="mt-4 rounded-xl px-3 py-2 text-sm font-medium text-white" style={{backgroundColor: BRAND.navy}}>Apply Filters</button>
                  </div>
                </Section>

                <div className="lg:col-span-2 space-y-6">
                  <Section title={`Results (${filtered.length})`} right={<button className="text-sm px-3 py-1 rounded-lg border" onClick={()=>setTab('leads')}>Go to Leads</button>}>
                    <div className="overflow-auto">
                      <table className="min-w-full text-sm">
                        <thead>
                          <tr className="text-left text-slate-500">
                            <th className="py-2 pr-3">Name</th>
                            <th className="py-2 pr-3">Industry</th>
                            <th className="py-2 pr-3">City</th>
                            <th className="py-2 pr-3">Miles</th>
                            <th className="py-2 pr-3">Source</th>
                            <th className="py-2 pr-3">Website</th>
                            <th className="py-2 pr-3"></th>
                          </tr>
                        </thead>
                        <tbody>
                          {filtered.map(p=> (
                            <tr key={p.id} className="border-t">
                              <td className="py-3 pr-3 font-medium">{p.name}</td>
                              <td className="py-3 pr-3">{p.industry}</td>
                              <td className="py-3 pr-3">{p.city}</td>
                              <td className="py-3 pr-3">{p.radiusMiles}</td>
                              <td className="py-3 pr-3">{p.source}</td>
                              <td className="py-3 pr-3">
                                {p.website && (p.website.startsWith('http://') || p.website.startsWith('https://')) ? (
                                  <a href={p.website} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">{p.website}</a>
                                ) : (
                                  p.website || '—'
                                )}
                              </td>
                              <td className="py-3 pr-3 text-right">
                                <button className="text-sm px-3 py-1 rounded-lg border mr-2" onClick={()=>{ setSelected(p); setTab('outreach'); }}>Outreach</button>
                                <button className="text-sm px-3 py-1 rounded-lg border" onClick={()=>{ setSelected(p); setTab('leads'); }}>Open</button>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </Section>

                  {selected && (
                    <Section title="Prospect Quick View">
                      <ProspectCard p={selected} />
                    </Section>
                  )}
                </div>
              </form>
            )}

            {tab==='leads' && (
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <Section title="Your Leads" right={<button className="text-sm px-3 py-1 rounded-lg border" onClick={addProspect}>+ Add</button>}>
                  <div className="overflow-auto">
                    <table className="min-w-full text-sm">
                      <thead>
                        <tr className="text-left text-slate-500">
                          <th className="py-2 pr-3">Name</th>
                          <th className="py-2 pr-3">Industry</th>
                          <th className="py-2 pr-3">Stage</th>
                          <th className="py-2 pr-3">City</th>
                          <th className="py-2 pr-3">Website</th>
                          <th className="py-2 pr-3"></th>
                        </tr>
                      </thead>
                      <tbody>
                        {prospects.map(p=> (
                          <tr key={p.id} className="border-t hover:bg-gray-50 cursor-pointer" onClick={()=>setSelected(p)}>
                            <td className="py-3 pr-3 font-medium">{p.name}</td>
                            <td className="py-3 pr-3">{p.industry}</td>
                            <td className="py-3 pr-3">{p.status}</td>
                            <td className="py-3 pr-3">{p.city}</td>
                            <td className="py-3 pr-3">
                              {p.website && (p.website.startsWith('http://') || p.website.startsWith('https://')) ? (
                                <a href={p.website} target="_blank" rel="noreferrer" className="text-blue-600 hover:underline">{p.website}</a>
                              ) : (
                                p.website || '—'
                              )}
                            </td>
                            <td className="py-3 pr-3 text-right">
                              <button className="text-sm px-3 py-1 rounded-lg border mr-2" onClick={(e)=>{ e.stopPropagation(); setSelected(p); setTab('outreach'); }}>Outreach</button>
                              <button className="text-sm px-3 py-1 rounded-lg border" onClick={(e)=>{ e.stopPropagation(); setSelected(p); }}>Edit</button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </Section>

                <div className="lg:col-span-2">
                  {selected ? (
                    <Section title={`Edit: ${selected.name}`} right={<button className="text-sm px-3 py-1 rounded-lg border" onClick={()=>setSelected(null)}>Close</button>}>
                      <Editor p={selected} onChange={updateProspect} onRemove={removeProspect} />
                    </Section>
                  ) : (
                    <div className="text-slate-500 text-sm">Select a lead to edit.</div>
                  )}
                </div>
              </div>
            )}

            {tab==='outreach' && (
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <Section title="Select a Prospect">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    {prospects.map(p=> (
                      <button key={p.id} onClick={()=>setSelected(p)} className={`text-left p-3 rounded-xl border ${selected?.id===p.id?'bg-white border-gray-300':'bg-gray-50 border-gray-200 hover:bg-white'}`}>
                        <div className="font-medium">{p.name}</div>
                        <div className="text-xs text-slate-500">{p.industry} • {p.city}</div>
                      </button>
                    ))}
                  </div>
                </Section>

                <Section title="Outreach Composer" right={selected && <CopyButton text={callScript(selected)} label="Copy All" onCopy={() => logActivity('outreach', `Copied all outreach for ${selected.name}`)} />}>
                  {!selected ? (
                    <div className="text-sm text-slate-500">Choose a prospect to generate scripts, emails and a letter.</div>
                  ) : (
                    <div className="space-y-6">
                      <div>
                        <div className="text-xs text-slate-500 mb-1">Recommended Products</div>
                        <div className="flex flex-wrap">{recommendProducts(selected.industry,[...(selected.flags||[]), selected.notes||'']).map(r=> <Tag key={r}>{r}</Tag>)}</div>
                      </div>
                      <div className="space-y-2">
                        <div className="flex items-center justify-between"><h4 className="font-semibold">Call Script</h4><CopyButton text={callScript(selected)} onCopy={() => logActivity('outreach', `Copied call script for ${selected.name}`)} /></div>
                        <pre className="whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-xl border">{callScript(selected)}</pre>
                      </div>
                      <div className="space-y-2">
                        <div className="flex items-center justify-between"><h4 className="font-semibold">Email</h4><CopyButton text={emailTemplate(selected)} onCopy={() => logActivity('outreach', `Copied email for ${selected.name}`)} /></div>
                        <pre className="whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-xl border">{emailTemplate(selected)}</pre>
                      </div>
                      <div className="space-y-2">
                        <div className="flex items-center justify-between"><h4 className="font-semibold">Mailable Letter (Print)</h4><button className="text-sm px-3 py-1 rounded-lg border" onClick={() => printLetter(letterTemplate(selected), () => logActivity('outreach', `Printed letter for ${selected.name}`))}>Print Letter</button></div>
                        <pre className="whitespace-pre-wrap text-sm bg-gray-50 p-3 rounded-xl border">{letterTemplate(selected)}</pre>
                      </div>
                    </div>
                  )}
                </Section>
              </div>
            )}

            {tab==='reports' && <Reports />}

            {tab==='settings' && (
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <Section title="Branding & Defaults">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                    <div><label className="block text-xs text-slate-500 mb-1">Brand Navy</label><input value={BRAND.navy} readOnly className="w-full rounded-lg border px-3 py-2" /></div>
                    <div><label className="block text-xs text-slate-500 mb-1">Brand Gold</label><input value={BRAND.gold} readOnly className="w-full rounded-lg border px-3 py-2" /></div>
                    <div><label className="block text-xs text-slate-500 mb-1">Default Radius (mi)</label><input type="number" value={settings.defaultRadius} onChange={e=>setSettings({...settings, defaultRadius:Number(e.target.value)})} className="w-full rounded-lg border px-3 py-2" /></div>
                    <div><label className="block text-xs text-slate-500 mb-1">Focus Industries</label><textarea value={settings.industries.join('\n')} onChange={e=>setSettings({...settings, industries:e.target.value.split(new RegExp('\r?\n+')).filter(Boolean)})} className="w-full rounded-lg border px-3 py-2 h-32" /></div>
                  </div>
                </Section>

                <Section title="Data Sources (Reference Links)">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                    <ListEditor label="Chamber URLs" list={settings.chamberUrls} onChange={(list)=>setSettings({...settings, chamberUrls:list})} />
                    <ListEditor label="CRE Sources" list={settings.creSources} onChange={(list)=>setSettings({...settings, creSources:list})} />
                    <ListEditor label="Recorder Portals" list={settings.recorderPortals} onChange={(list)=>setSettings({...settings, recorderPortals:list})} />
                  </div>
                </Section>

                <Section title="Agent Login (Phase 2)" right={<span className="text-xs text-slate-500">stub only</span>}>
                  <p className="text-sm text-slate-700 mb-3">When enabled, credentials are stored in <b>session</b> only (not persisted). Bots can search after you authenticate.</p>
                  <div className="flex items-center gap-3 text-sm"><label className="inline-flex items-center gap-2"><input type="checkbox" checked={settings.agentLogin.enabled} onChange={e=>setSettings({...settings, agentLogin:{...settings.agentLogin, enabled:e.target.checked}})} />Enable Agent-Assisted Recorder Search</label><span className="text-xs text-slate-500">Respect each portal’s Terms of Use.</span></div>
                </Section>

                <Section title="About This Tool">
                  <div className="text-sm text-slate-700 space-y-2">
                    <p><b>Purpose:</b> A one-stop prospecting & outreach app for commercial lending (solo edition).</p>
                    <p><b>Roadmap:</b> (1) Chamber & CRE feeds → (2) Recorder/UCC agents → (3) Enrichment → (4) Map heatmaps & scoring.</p>
                    <p><b>Security:</b> Prototype stores data in your browser only. Do not paste sensitive credentials.</p>
                  </div>
                </Section>
              </div>
            )}
          </main>

          <footer className="py-8">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 text-xs text-slate-500">© {new Date().getFullYear()} {JAY.bank}. Prototype for internal concepting.</div>
          </footer>
        </div>
      );
    }

    // ===== Mount React App with error-fallback (visible error instead of blank page)
    try {
      const rootEl = document.getElementById('root');
      const root = ReactDOM.createRoot(rootEl);
      root.render(<App/>);
    } catch (err) {
      console.error('Failed to mount app:', err);
      const box = document.createElement('div');
      box.style.cssText = 'background:#fee2e2;color:#991b1b;padding:12px;border:1px solid #fecaca;border-radius:12px;margin:16px;font:13px ui-sans-serif,system-ui';
      box.textContent = 'Mount error: ' + (err && err.message ? err.message : err);
      document.body.appendChild(box);
    }
  
(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9797c95e1833e776',t:'MTc1NjkyOTEzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9797cdc938d4e776',t:'MTc1NjkyOTMxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9797d1ce59d5e776',t:'MTc1NjkyOTQ4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9797d93ba8ade776',t:'MTc1NjkyOTc4Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979ffef89866f06a',t:'MTc1NzAxNTIxOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();
